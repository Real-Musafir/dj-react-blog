(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{159:function(e,t,a){e.exports=a(297)},188:function(e,t){},190:function(e,t){},202:function(e,t){},204:function(e,t){},232:function(e,t){},234:function(e,t){},235:function(e,t){},241:function(e,t){},243:function(e,t){},261:function(e,t){},263:function(e,t){},275:function(e,t){},278:function(e,t){},296:function(e,t,a){},297:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(29),o=a.n(l),c=a(19),s=a(13),m=a(9),i=a(77),u=a.n(i),d=a(151),f=a(152),p="https://dr-blog1.herokuapp.com/api/",b=a.n(f).a.create({baseURL:p,timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT "+localStorage.getItem("access_token"):null,"Content-Type":"application/json",accept:"application/json"}});b.interceptors.response.use((function(e){return e}),function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.config,"undefined"!==typeof t.response){e.next=4;break}return alert("A server/network error occurred. Looks like CORS might be the problem. Sorry about this - we will get it fixed shortly."),e.abrupt("return",Promise.reject(t));case 4:if(401!==t.response.status||a.url!==p+"token/refresh/"){e.next=7;break}return window.location.href="/login/",e.abrupt("return",Promise.reject(t));case 7:if("token_not_valid"!==t.response.data.code||401!==t.response.status||"Unauthorized"!==t.response.statusText){e.next=23;break}if(!(n=localStorage.getItem("refresh_token"))){e.next=21;break}if(r=JSON.parse(atob(n.split(".")[1])),l=Math.ceil(Date.now()/1e3),console.log(r.exp),!(r.exp>l)){e.next=17;break}return e.abrupt("return",b.post("/token/refresh/",{refresh:n}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),b.defaults.headers.Authorization="JWT "+e.data.access,a.headers.Authorization="JWT "+e.data.access,b(a)})).catch((function(e){console.log(e)})));case 17:console.log("Refresh token is expired",r.exp,l),window.location.href="/login/";case 19:e.next=23;break;case 21:console.log("Refresh token not available."),window.location.href="/login/";case 23:return e.abrupt("return",Promise.reject(t));case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var E=b,g=a(6),v=a(7),h=function(){var e=Object(g.f)(),t=Object.freeze({email:"",password:""}),a=Object(n.useState)(t),l=Object(m.a)(a,2),o=l[0],i=l[1],u=function(e){i(Object(s.a)(Object(s.a)({},o),{},Object(c.a)({},e.target.name,e.target.value.trim())))};return r.a.createElement("div",{className:"container col-md-6 col-md-offset-3 my-5 border border-info"},r.a.createElement("form",{className:"my-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Email address"),r.a.createElement("input",{type:"email",className:"form-control border border-info",name:"email",placeholder:"Enter Email",onChange:u})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",className:"form-control border border-info",name:"password",placeholder:"Password",onChange:u})),r.a.createElement("button",{type:"submit",className:"btn btn-info",onClick:function(t){t.preventDefault(),console.log(o),E.post("token/",{email:o.email,password:o.password}).then((function(t){localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),E.defaults.headers.Authorization="JWT "+localStorage.getItem("access_token"),e.push("/")}))}},"Login"),r.a.createElement("div",{className:"my-2"},r.a.createElement("small",null,"don't have an accout register "),r.a.createElement(v.c,{exact:!0,to:"/register"},r.a.createElement("small",{className:"ml-2 "},"here")))))},N=function(){return r.a.createElement("nav",{className:"navbar navbar-expand navHead"},r.a.createElement(v.b,{className:"navbar-brand",style:{color:"white"},to:"/"},"Blog"),r.a.createElement("div",{className:"collapse navbar-collapse ",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav mr-auto navButton"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(v.c,{className:"nav-link navButtonIn",exact:!0,to:""},"Home ",r.a.createElement("span",{className:"sr-only"},"(current)")))),r.a.createElement("ul",{className:"navbar-nav "},r.a.createElement("li",{className:"nav-item navButton"},r.a.createElement(v.c,{className:"nav-link navButtonIn",exact:!0,to:"/register"},"Register")),r.a.createElement("li",{className:"nav-item navButton"},r.a.createElement(v.c,{className:"nav-link navButtonIn",exact:!0,to:"/login"},"Login")),r.a.createElement("li",{className:"nav-item navButton"},r.a.createElement(v.c,{className:"nav-link navButtonIn",exact:!0,to:"/logout"},"Logout")))))},y=a(154),k=a(300),j=a(299),O=function(e){var t=e.slug,a=Object(g.f)(),l=Object.freeze({title:"",content:""}),o=Object(n.useState)(l),i=Object(m.a)(o,2),u=i[0],d=i[1];Object(n.useEffect)((function(){E.get("posts/"+t+"/").then((function(e){var t;d(Object(s.a)(Object(s.a)({},u),{},(t={},Object(c.a)(t,"title",e.data.title),Object(c.a)(t,"content",e.data.content),t)))}))}),[d]);var f=function(e){d(Object(s.a)(Object(s.a)({},u),{},Object(c.a)({},e.target.name,e.target.value.trim())))};return r.a.createElement("div",{className:"container col-md-6 col-md-offset-3 my-5 border border-info"},r.a.createElement("form",{className:"my-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Title"),r.a.createElement("input",{type:"text",className:"form-control border border-info",name:"title",placeholder:"Enter Post Title",value:u.title,onChange:f})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Content"),r.a.createElement("textarea",{type:"text",className:"form-control border border-info",name:"content",placeholder:"content",value:u.content,onChange:f})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn btn-info",onClick:function(e){e.preventDefault(),E.put("posts/edit/"+t+"/",{title:u.title,content:u.content});a.push({pathname:"/"}),window.location.reload()}},"Edit Post")))};var C=function(e){var t=Object(n.useState)(!1),l=Object(m.a)(t,2),o=l[0],c=l[1],s=Object(n.useState)([]),i=Object(m.a)(s,2),u=i[0],d=i[1],f=function(){return c(!1)},p=e.slug,b="",g=localStorage.getItem("access_token")?localStorage.getItem("access_token"):null;if(g){var h=g;b=a(92).decode(h).user_id}var N=Object(n.useState)([]),y=Object(m.a)(N,2),C=y[0],w=y[1];Object(n.useEffect)((function(){E.get("posts/"+p+"/").then((function(e){w(e.data)}))}),[w]);var x=!1;b===C.user&&(x=!0);var S=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"card mx-auto my-3 border border-info",style:{width:"25rem"}},r.a.createElement("img",{src:C.image,className:"card-img-top img-responsive",alt:""}),x&&r.a.createElement("div",{className:"d-flex"},r.a.createElement("div",{className:"my-1"},r.a.createElement("div",null,r.a.createElement(k.a,{className:"my-2 ml-3",variant:"primary",onClick:function(){var e;e=C.slug,d(e),console.log(u,"from slug"),c(!0)}},"Edit"))),r.a.createElement("div",{className:"my-1"},r.a.createElement(v.c,{className:"nav-link ",exact:!0,to:"/posts/delete/"+C.slug},r.a.createElement("button",{className:"btn btn-danger"},"Delete")," ",r.a.createElement("span",{className:"sr-only"},"(current)")))),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},C.title),r.a.createElement("p",{className:"card-text"},C.content))))};function I(){return r.a.createElement(j.a,{animation:!1,show:o,onHide:f},r.a.createElement(j.a.Header,{closeButton:!0,style:{backgroundColor:" #0020C2"}}),r.a.createElement(j.a.Body,{style:{backgroundColor:" #0020C2"}},r.a.createElement(O,{slug:p})),r.a.createElement(j.a.Footer,{style:{backgroundColor:" #0020C2"}},r.a.createElement(k.a,{variant:"secondary",onClick:f},"Close")))}return r.a.createElement("div",null,r.a.createElement(S,null),r.a.createElement(I,null))};var w=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)([]),c=Object(m.a)(o,2),s=c[0],i=c[1];function u(e){i(e),console.log(s,"from slug")}var d=function(){return l(!1)},f=function(){return l(!0)},p=Object(n.useState)([]),b=Object(m.a)(p,2),g=b[0],v=b[1];Object(n.useEffect)((function(){E.get("posts/").then((function(e){var t=e.data;v(t)}))}),[v]);var h=function(){return r.a.createElement("div",null,g.map((function(e){return r.a.createElement("div",{className:"card mx-auto my-3 border:none",style:{backgroundColor:"#2B60DE",width:"38rem",color:"white"},key:e.id},r.a.createElement("a",{onClick:function(){u(e.slug),f()}},e.image&&r.a.createElement("img",{src:e.image,className:"card-img-top class='img-responsive my-2",style:{width:"15rem",height:"15rem",marginLeft:"10rem"}})),r.a.createElement("div",{className:"card-body"},r.a.createElement("small",null,"Posted By ",r.a.createElement("strong",null,e.user)," at ",Intl.DateTimeFormat("en-US").format(new Date(e.timestamp).getTime())),r.a.createElement("h5",{className:"card-title"},e.title),r.a.createElement(y.a,{lines:1,ellipsis:r.a.createElement("span",{className:"d-flex"},"... ","",r.a.createElement("a",{style:{color:"whilte"},href:"#",onClick:function(){u(e.slug),f()}},"read"))},e.content),r.a.createElement("div",null,r.a.createElement(k.a,{className:"my-2",variant:"primary",onClick:function(){u(e.slug),f()}},"Detail"))))})))};function N(){return r.a.createElement(j.a,{animation:!1,show:a,onHide:d},r.a.createElement(j.a.Header,{closeButton:!0,style:{backgroundColor:" #0020C2"}}),r.a.createElement(j.a.Body,{style:{backgroundColor:" #0020C2"}},r.a.createElement(C,{slug:s})),r.a.createElement(j.a.Footer,{style:{backgroundColor:" #0020C2"}},r.a.createElement(k.a,{variant:"secondary",onClick:d},"Close")))}return r.a.createElement("div",null,r.a.createElement(h,null),r.a.createElement(N,null))};function x(){var e="",t=localStorage.getItem("access_token")?localStorage.getItem("access_token"):null;if(t){var l=t,o=a(92).decode(l);e=o.user_id}var i=Object(g.f)(),u=Object.freeze({user:e,title:"",content:""}),d=Object(n.useState)(u),f=Object(m.a)(d,2),p=f[0],b=f[1],v=Object(n.useState)(null),N=Object(m.a)(v,2),y=N[0],k=N[1],j=function(e){"image"==[e.target.name]&&(k({image:e.target.files}),console.log(e.target.files)),b(Object(s.a)(Object(s.a)({},p),{},Object(c.a)({},e.target.name,e.target.value.trim())))};return e?r.a.createElement("div",null,r.a.createElement("div",{className:"container col-md-6 col-md-offset-3 my-5 border border-info"},r.a.createElement("form",{className:"my-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Title"),r.a.createElement("input",{type:"text",className:"form-control border border-info",name:"title",placeholder:"Enter Post Title",onChange:j})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Content"),r.a.createElement("textarea",{type:"text",className:"form-control border border-info",name:"content",placeholder:"content",onChange:j})),r.a.createElement("input",{className:"my-2",accept:"image/*",id:"image",onChange:j,name:"image",type:"file"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn btn-info",onClick:function(t){t.preventDefault();var a=new FormData;a.append("user",e),a.append("title",p.title),a.append("content",p.content),y&&a.append("image",y.image[0]),E.post("posts/create/",a),i.push({pathname:"/"}),window.location.reload()}},"Submit")))):r.a.createElement("div",null,r.a.createElement("h4",{className:"container col-md-5 my-3"},"You Must Be Login First To Create A Post"),r.a.createElement(h,null))}var S=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],l=t[1],o=function(){return l(!1)},c=function(){return l(!0)};function s(){return r.a.createElement("div",null,r.a.createElement("div",{style:{backgroundColor:" #0020C2"}},r.a.createElement("div",{className:"col-sm-4 container "},r.a.createElement(k.a,{className:" btn btn-primary col-5 l-10 ",onClick:c},"Create Post"))),r.a.createElement(j.a,{animation:!1,show:a,onHide:o},r.a.createElement(j.a.Header,{closeButton:!0,style:{backgroundColor:" #0020C2"}}),r.a.createElement(j.a.Body,{style:{backgroundColor:" #0020C2"}},r.a.createElement(x,null)),r.a.createElement(j.a.Footer,{style:{backgroundColor:" #0020C2"}},r.a.createElement(k.a,{variant:"secondary",onClick:o},"Close"))))}return r.a.createElement("div",null,r.a.createElement("div",{style:{backgroundColor:" #0020C2"}},r.a.createElement(s,null),r.a.createElement(w,null)))};function I(){var e=Object(g.f)();return Object(n.useEffect)((function(){E.post("user/logout/blacklist/",{refresh_token:localStorage.getItem("refresh_token")});localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),E.defaults.headers.Authorization=null,e.push("/login")})),r.a.createElement("div",null,"Logout")}var _=function(){var e=Object(g.f)(),t=Object.freeze({email:"",username:"",password:""}),a=Object(n.useState)(t),l=Object(m.a)(a,2),o=l[0],i=l[1],u=function(e){i(Object(s.a)(Object(s.a)({},o),{},Object(c.a)({},e.target.name,e.target.value.trim())))};return r.a.createElement("div",{className:"container col-md-6 col-md-offset-3 my-5 border border-info"},r.a.createElement("form",{className:"my-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Email address"),r.a.createElement("input",{type:"email",className:"form-control border border-info",name:"email",placeholder:"Enter Email",onChange:u})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"User Name"),r.a.createElement("input",{type:"text",className:"form-control border border-info",name:"username",placeholder:"Enter Username",onChange:u})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",className:"form-control border border-info",name:"password",placeholder:"Password",onChange:u})),r.a.createElement("button",{type:"submit",className:"btn btn-info",onClick:function(t){t.preventDefault(),console.log(o),E.post("user/register/",{email:o.email,user_name:o.username,password:o.password}).then((function(t){e.push("/login"),console.log(t),console.log(t.data)}))}},"Register"),r.a.createElement("div",{className:"my-2"},r.a.createElement("small",null,"al ready have an account login "),r.a.createElement(v.c,{exact:!0,to:"/login"},r.a.createElement("small",{className:"ml-2 "},"here")))))};function B(){var e=Object(g.f)(),t=Object(g.g)().slug;return r.a.createElement("div",{className:"container d-flex col-6 mt-3",onClick:function(a){a.preventDefault(),E.delete("posts/delete/"+t+"/").catch((function(e){e.response&&(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers))})).then((function(){e.push({pathname:"/"}),window.location.reload()}))}},r.a.createElement("h3",null," Do you want to delete this post?"),r.a.createElement("button",{className:"btn btn-danger ml-3"}," Confirm"))}a(296);var D=function(){return r.a.createElement(v.a,null,r.a.createElement(N,null),r.a.createElement(g.c,null,r.a.createElement(g.a,{exact:!0,path:"/",component:S}),r.a.createElement(g.a,{exact:!0,path:"/login",component:h}),r.a.createElement(g.a,{exact:!0,path:"/logout",component:I}),r.a.createElement(g.a,{exact:!0,path:"/register",component:_}),r.a.createElement(g.a,{exact:!0,path:"/posts/create",component:x}),r.a.createElement(g.a,{exact:!0,path:"/posts/:slug",component:C}),r.a.createElement(g.a,{exact:!0,path:"/posts/edit/:slug",component:O}),r.a.createElement(g.a,{exact:!0,path:"/posts/delete/:slug",component:B})))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root"))}},[[159,1,2]]]);
//# sourceMappingURL=main.11eb708d.chunk.js.map